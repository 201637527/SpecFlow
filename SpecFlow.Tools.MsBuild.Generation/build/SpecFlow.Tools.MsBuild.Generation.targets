<Project>

  
  <Target Name="GenerateCodeBehind" BeforeTargets="PreBuildEvent" DependsOnTargets="$(SpecFlow_TargetOrder)">

  </Target>

  
  <Target Name="UpdateFeatureFilesInProject" DependsOnTargets="BeforeUpdateFeatureFilesInProject" >
    
    <PropertyGroup>
      <SpecFlowCodeBehindOutputPath Condition="'$(SpecFlowCodeBehindOutputPath)' == ''">Features.Generated</SpecFlowCodeBehindOutputPath>
    </PropertyGroup>

    <ItemGroup Condition=" '@(SpecFlowFeatureFiles)' == ''">
      <SpecFlowFeatureFiles Include="**\*.feature"/>
      <SpecFlowFeatureFiles Include="**\*.feature.xlsx" />
    </ItemGroup>

  </Target>

  <Target Name="GenerateFeatureCodeBehindFiles" Inputs="@(SpecFlowFeatureFiles)" Outputs="@(SpecFlowFeatureFiles->'$(SpecFlowCodeBehindOutputPath)\%(RelativeDir)%(Filename).feature.cs')" DependsOnTargets="UpdateFeatureFilesInProject">
  <!--<Target Name="GenerateFeatureCodeBehindFiles" DependsOnTargets="UpdateFeatureFilesInProject">-->
    <GenerateFeatureFileCodeBehindTask
      ProjectPath="$(MSBuildProjectFullPath)"
      OutputPath="$(SpecFlowCodeBehindOutputPath)"
      FeatureFiles="@(SpecFlowFeatureFiles)"
      RootNamespace="$(RootNamespace)">
      
      <Output TaskParameter="GeneratedFiles" ItemName="SpecFlowGeneratedFiles" />
    </GenerateFeatureFileCodeBehindTask>
  </Target>

  <Target Name="SpecFlow_UpdateCompileItemGroup">
    <ItemGroup>
      <Compile Include="@(SpecFlowGeneratedFiles)"/>
    </ItemGroup>
  </Target>

  <Target Name="BeforeUpdateFeatureFilesInProject">

  </Target>

  <Target Name="AfterUpdateFeatureFilesInProject" DependsOnTargets="UpdateFeatureFilesInProject">
  </Target>
</Project>